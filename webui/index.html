<html>

<head>
    <title>Air Quality</title>
    <script src="http://192.168.0.112/json"></script>
</head>

<body>
    Current AQI: <span id="aqi"></span> <span id="aqi_name"></span><br>
    PM 1.0: <span id="pm_1_0"></span><br>
    PM 2.5: <span id="pm_2_5"></span><br>
    PM 10.0: <span id="pm_10_0"></span><br>
    Temperature: <span id="temp"></span>&deg;C / <span id="temp_f"></span>&deg;F<br>
    Humidity: <span id="humidity"></span>&percnt;<br>
    Pressure: <span id="pressure"></span> hPa<br>
    <script>
        function Linear(AQIhigh, AQIlow, Conchigh, Conclow, Concentration) {
            var linear;
            var Conc = parseFloat(Concentration);
            var a;
            a = ((Conc - Conclow) / (Conchigh - Conclow)) * (AQIhigh - AQIlow) + AQIlow;
            linear = Math.round(a);
            return linear;
        }

        function AQIPM25(Concentration) {
            var Conc = parseFloat(Concentration);
            var c;
            var AQI;
            var AQI_NAME
            c = (Math.floor(10 * Conc)) / 10;
            if (c >= 0 && c < 12.1) {
                AQI = Linear(50, 0, 12, 0, c);
                AQI_NAME = "Good";
            } else if (c >= 12.1 && c < 35.5) {
                AQI = Linear(100, 51, 35.4, 12.1, c);
                AQI_NAME = "Moderate";
            } else if (c >= 35.5 && c < 55.5) {
                AQI = Linear(150, 101, 55.4, 35.5, c);
                AQI_NAME = "Unhealthy for Sensitive Groups";
            } else if (c >= 55.5 && c < 150.5) {
                AQI = Linear(200, 151, 150.4, 55.5, c);
                AQI_NAME = "Unhealthy";
            } else if (c >= 150.5 && c < 250.5) {
                AQI = Linear(300, 201, 250.4, 150.5, c);
                AQI_NAME = "Very Unhealthy";
            } else if (c >= 250.5 && c < 350.5) {
                AQI = Linear(400, 301, 350.4, 250.5, c);
                AQI_NAME = "Hazardous";
            } else if (c >= 350.5 && c < 500.5) {
                AQI = Linear(500, 401, 500.4, 350.5, c);
                AQI_NAME = "Super Hazardous";
            } else {
                AQI = "999";
                AQI_NAME = "Apocalyptic";
            }
            return [AQI, AQI_NAME];
        }
        var aq = AQIPM25(aq_data.pm_2_5);
        var aqi = aq[0]
        var aqi_name = aq[1]
        document.getElementById("aqi").innerHTML = aqi;
        document.getElementById("aqi_name").innerHTML = aqi_name;
        document.getElementById("pm_1_0").innerHTML = aq_data.pm_1_0;
        document.getElementById("pm_2_5").innerHTML = aq_data.pm_2_5;
        document.getElementById("pm_10_0").innerHTML = aq_data.pm_10_0;
        document.getElementById("temp").innerHTML = aq_data.temp.toFixed(2);
        document.getElementById("temp_f").innerHTML = (aq_data.temp * 1.8 + 32).toFixed(2);
        document.getElementById("humidity").innerHTML = aq_data.humidity.toFixed(2);;
        document.getElementById("pressure").innerHTML = aq_data.pressure.toFixed(2);;
    </script>
</body>

</html>